theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
)
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
" Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F")) +
labs(
x = x_axis_label,
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
" Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
labs(
x = x_axis_label,
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
ggsave(filename = "dXY.eps", plot = fig2)
ggsave(filename = "dXY.png", plot = fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"), "\n",
" Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
labs(
x = x_axis_label,
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
phantom(), "\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
labs(
x = x_axis_label,
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
labs(
x = x_axis_label,
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
labs(
x = "Mean Italic('H. pulcherrimus') - Italic('S. fragilis')\nAbsolute Nucleotide Divergence (Italic('d')[XY])",
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) + expression(paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\nAbsolute Nucleotide Divergence (", italic("d")[XY], ")")),
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
labs(
x = expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\nAbsolute Nucleotide Divergence (", italic("d")[XY], ")")
),
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) +
x = expression(
atop(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis")),
paste("Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
),
x_axis_label <- expression(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis"),
"\n Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) + labs(
x = expression(
atop(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis")),
paste("Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
),
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
ggsave(filename = "dXY.eps", plot = fig2)
ggsave(filename = "dXY.png", plot = fig2)
knitr::opts_chunk$set(echo = TRUE)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) + labs(
x = expression(
atop(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis")),
paste("Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
),
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL)) +
xlim(0,NA)
library(sjPlot)
library(fitdistrplus)
library(ggplot2)
library(ggpubr)
library(plyr)
library(dplyr)
library(fitdistrplus)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) + labs(
x = expression(
atop(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis")),
paste("Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
),
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL)) +
xlim(0,NA)
plot(fig2)
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) + labs(
x = expression(
atop(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis")),
paste("Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
),
y = "Probability Denstiy",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
knitr::opts_chunk$set(echo = TRUE)
library(sjPlot)
library(fitdistrplus)
library(ggplot2)
library(ggpubr)
library(plyr)
library(dplyr)
library(fitdistrplus)
dist_introgression_tract_dxy_90 <- scan("introgression_tracts_mean_dxy_dist_90.csv", what = numeric(), sep = ",")
dist_species_tree_tract_dxy_90 <- scan("species_tree_tracts_mean_dxy_dist_90.csv", what = numeric(), sep = ",")
dist_introgression_tract_dxy_80 <- scan("introgression_tracts_mean_dxy_dist_80.csv", what = numeric(), sep = ",")
dist_species_tree_tract_dxy_80 <- scan("species_tree_tracts_mean_dxy_dist_80.csv", what = numeric(), sep = ",")
df <- data.frame(
dist_type = factor(c(rep("introgression_tract", 1000), rep("species_tree_tract", 1000), rep("introgression_tract", 1000), rep("species_tree_tract", 1000))),
mean_divergence = c(dist_introgression_tract_dxy_90, dist_species_tree_tract_dxy_90, dist_introgression_tract_dxy_80, dist_species_tree_tract_dxy_80),
posterior_probability = factor(c(rep("probability_90", 2000), rep("probability_80", 2000)))
)
df$posterior_probability <- factor(df$posterior_probability, levels = c("probability_90", "probability_80"))
fig2 <- ggplot(data = df, aes(x = mean_divergence, fill = dist_type)) +
geom_density(aes(y=after_stat(density))) +
facet_wrap(
~ posterior_probability,
ncol = 1,
scales = "free_y",
#scales = "free_x",
labeller = labeller(
posterior_probability = c(
"probability_90" = "Posterior Probability Threshold: 90%",
"probability_80" = "Posterior Probability Threshold: 80%"
)
)
) +
scale_fill_manual(values = c("introgression_tract" = "#A6CEE3", "species_tree_tract" = "#FDBF6F"), labels = c("introgression_tract" = "Introgression Tracts", "species_tree_tract" = "Genome-Wide Background")
) + labs(
x = expression(
atop(
paste("Mean ", italic("H. pulcherrimus"), " - ", italic("S. fragilis")),
paste("Absolute Nucleotide Divergence (", italic("d")[XY], ")")
)
),
y = "Probability Density",
fill = "Dist Type"
) + theme_blank() +
theme(
axis.title = element_text(size = 14),
legend.position = "right",
panel.grid = element_blank(),
) +
guides(fill = guide_legend(title = NULL))
plot(fig2)
ggsave(filename = "dXY.eps", plot = fig2)
ggsave(filename = "dXY.png", plot = fig2)
library(ggplot2)
library(fitdistrplus)
library(sjPlot)
library(ggpubr)
library(plyr)
library(dplyr)
library(tidyr)
library(ggh4x)
# Change margin settings
#par(mar=c(2,2,2,1))
setwd("/Users/matt/Documents/Github/dissertation_chapter_2/paml/")
introgression_tract_dN_90 = "mean_dN_introgression_tract_90.csv"
species_tree_tract_dN_90 = "mean_dN_species_tree_90.csv"
introgression_tract_dS_90 = "mean_dS_introgression_tract_90.csv"
species_tree_tract_dS_90 = "mean_dS_species_tree_90.csv"
introgression_tract_dNdS_90 = "mean_dNdS_introgression_tract_90.csv"
species_tree_tract_dNdS_90 = "mean_dNdS_species_tree_90.csv"
introgression_tract_dN_80 = "mean_dN_introgression_tract_80.csv"
species_tree_tract_dN_80 = "mean_dN_species_tree_80.csv"
introgression_tract_dS_80 = "mean_dS_introgression_tract_80.csv"
species_tree_tract_dS_80 = "mean_dS_species_tree_80.csv"
introgression_tract_dNdS_80 = "mean_dNdS_introgression_tract_80.csv"
species_tree_tract_dNdS_80 = "mean_dNdS_species_tree_80.csv"
# Read the CSV file as a one-dimensional vector
dist_dN_introgression_tract_90 <- scan(introgression_tract_dN_90, what = numeric(), sep = ",")
dist_dN_species_tree_90 <- scan(species_tree_tract_dN_90, what = numeric(), sep = ",")
dist_dS_introgression_tract_90 <- scan(introgression_tract_dS_90, what = numeric(), sep = ",")
dist_dS_species_tree_90 <- scan(species_tree_tract_dS_90, what = numeric(), sep = ",")
dist_dNdS_introgression_tract_90 <- scan(introgression_tract_dNdS_90, what = numeric(), sep = ",")
dist_dNdS_species_tree_90 <- scan(species_tree_tract_dNdS_90, what = numeric(), sep = ",")
dist_dN_introgression_tract_80 <- scan(introgression_tract_dN_80, what = numeric(), sep = ",")
dist_dN_species_tree_80 <- scan(species_tree_tract_dN_80, what = numeric(), sep = ",")
dist_dS_introgression_tract_80 <- scan(introgression_tract_dS_80, what = numeric(), sep = ",")
dist_dS_species_tree_80 <- scan(species_tree_tract_dS_80, what = numeric(), sep = ",")
dist_dNdS_introgression_tract_80 <- scan(introgression_tract_dNdS_80, what = numeric(), sep = ",")
dist_dNdS_species_tree_80 <- scan(species_tree_tract_dNdS_80, what = numeric(), sep = ",")
df <- data.frame(
dist_type = factor(c(rep("introgression_tract", 1000), rep("species_tree_tract", 1000), rep("introgression_tract", 1000), rep("species_tree_tract", 1000))),
mean_dN = c(dist_dN_introgression_tract_90, dist_dN_species_tree_90, dist_dN_introgression_tract_80, dist_dN_species_tree_80),
mean_dS = c(dist_dS_introgression_tract_90, dist_dS_species_tree_90, dist_dS_introgression_tract_80, dist_dS_species_tree_80),
mean_dNdS = c(dist_dNdS_introgression_tract_90, dist_dNdS_species_tree_90, dist_dNdS_introgression_tract_80, dist_dNdS_species_tree_80),
posterior_probability = factor(c(rep("probability_90", 2000), rep("probability_80", 2000)))
)
mean(dist_dN_introgression_tract_80)
mean(dist_dN_species_tree_80)
mean(dist_dS_introgression_tract_80)
mean(dist_dS_species_tree_80)
mean(dist_dNdS_introgression_tract_80)
mean(dist_dNdS_species_tree_80)
